/*!
 * mixpanel-lite.js - v1.1.2
 * Lightweight version of mixpanel-js with offline support
 * https://github.com/john-doherty/mixpanel-lite
 * @author John Doherty <www.johndoherty.info>
 * @license MIT
 */
!function(e,t){"use strict";if(e.localStorage)if(e.Promise){var r="https://api.mixpanel.com/track?ip=1&verbose=1&data=",n="https://api.mixpanel.com/engage?ip=1&verbose=1&data=",i=null,o=!1,a={},s={_key:"mixpanel-lite",all:function(){return JSON.parse(localStorage.getItem(s._key)||"[]")},add:function(e){var t=s.all();t.push(e),localStorage.setItem(s._key,JSON.stringify(t))},clear:function(){localStorage.setItem(s._key,JSON.stringify([]))},reset:function(e){localStorage.setItem(s._key,JSON.stringify(e||[]))}};e.addEventListener(e.cordova?"deviceready":"load",c,{passive:!0}),e.addEventListener("online",c,{passive:!0}),e.mixpanel={init:d,track:l,reset:function(){d(i),o&&console.log("mixpanel.reset()")},identify:function(e){e&&""!==e.trim()?(o&&console.log("mixpanel.identify('"+e+"')"),l("$identify",{$anon_distinct_id:a.distinct_id,distinct_id:e,$user_id:e}),a.distinct_id=e,a.$user_id=e):console.warn("Mixpanel.track: Invalid id")},people:{set:function(e){if(e&&"object"==typeof e){if(1!=navigator.doNotTrack){var t={$token:i,$distinct_id:a.distinct_id,$set:{}};Object.keys(e||{}).forEach(function(r){t.$set[r]=e[r]}),Object.keys(t.$set).forEach(function(e){t.$set[e]&&""!==t.$set[e]||delete t.$set[e]}),s.add(t),c()}}else console.warn("Mixpanel.track: Invalid data param, must be an object")}}}}else console.warn("mixpanel-lite: Promise not supported (try adding a polyfill)");else console.warn("mixpanel-lite: localStorage not supported");function d(r,n){if(""!==(r=String(r||""))){i=r,o=!0===(n||{}).debug;var s,d,l,c=(s=function(){for(var e=1*new Date,t=0;e==1*new Date;)t++;return e.toString(16)+t.toString(16)},d=(screen.height*screen.width).toString(16),s()+"-"+Math.random().toString(16).replace(".","")+"-"+function(){var e,t,r=navigator.userAgent,n=[],i=0;function o(e,t){var r,i=0;for(r=0;r<t.length;r++)i|=n[r]<<8*r;return e^i}for(e=0;e<r.length;e++)t=r.charCodeAt(e),n.unshift(255&t),n.length>=4&&(i=o(i,n),n=[]);return n.length>0&&(i=o(i,n)),i.toString(16)}()+"-"+d+"-"+s());return a={token:r,$current_url:e.location.href,$os:(l=navigator.userAgent,/Windows/i.test(l)?/Phone/.test(l)||/WPDesktop/.test(l)?"Windows Phone":"Windows":/(iPhone|iPad|iPod)/.test(l)?"iOS":/Android/.test(l)?"Android":/(BlackBerry|PlayBook|BB10)/i.test(l)?"BlackBerry":/Mac/i.test(l)?"Mac OS X":/Linux/.test(l)?"Linux":/CrOS/.test(l)?"Chrome OS":""),$browser:u(),$browser_version:function(){var e=u(),t=navigator.userAgent,r={"Internet Explorer Mobile":/rv:(\d+(\.\d+)?)/,"Microsoft Edge":/Edge\/(\d+(\.\d+)?)/,Chrome:/Chrome\/(\d+(\.\d+)?)/,"Chrome iOS":/CriOS\/(\d+(\.\d+)?)/,"UC Browser":/(UCBrowser|UCWEB)\/(\d+(\.\d+)?)/,Safari:/Version\/(\d+(\.\d+)?)/,"Mobile Safari":/Version\/(\d+(\.\d+)?)/,Opera:/(Opera|OPR)\/(\d+(\.\d+)?)/,Firefox:/Firefox\/(\d+(\.\d+)?)/,"Firefox iOS":/FxiOS\/(\d+(\.\d+)?)/,Konqueror:/Konqueror:(\d+(\.\d+)?)/,BlackBerry:/BlackBerry (\d+(\.\d+)?)/,"Android Mobile":/android\s(\d+(\.\d+)?)/,"Internet Explorer":/(rv:|MSIE )(\d+(\.\d+)?)/,Mozilla:/rv:(\d+(\.\d+)?)/}[e];if(void 0===r)return null;var n=t.match(r);if(!n)return null;return parseFloat(n[n.length-2])}(),$device:function(){var e=navigator.userAgent;return/Windows Phone/i.test(e)||/WPDesktop/.test(e)?"Windows Phone":/iPad/.test(e)?"iPad":/iPod/.test(e)?"iPod Touch":/iPhone/.test(e)?"iPhone":/(BlackBerry|PlayBook|BB10)/i.test(e)?"BlackBerry":/Android/.test(e)?"Android":""}(),$screen_height:screen.height,$screen_width:screen.width,$referrer:t.referrer,$referring_domain:function(){var e=String(t.referrer||"").split("/");if(e.length>=3)return e[2];return""}(),distinct_id:c,$device_id:c,mp_lib:"mixpanel-lite",$lib_version:"1.0.5"},o&&console.log("mixpanel.init('"+i+"')"),!0}console.warn("mixpanel.init: Invalid token")}function l(e,t){if(i)if(e&&""!==e){if(t&&"object"!=typeof t)console.warn("Mixpanel.track: Data param must be an object");else if(1!=navigator.doNotTrack){var r,n={event:e,properties:(r=a,JSON.parse(JSON.stringify(r)))};Object.keys(t||{}).forEach(function(e){n.properties[e]=t[e]}),Object.keys(n.properties).forEach(function(e){n.properties[e]&&""!==n.properties[e]||delete n.properties[e]}),s.add(n),c(),o&&(t?console.log("mixpanel.track('"+e+"',"+JSON.stringify(t||{})+")"):console.log("mixpanel.track('"+e+"')"),console.dir(n))}}else console.warn("Mixpanel.track: Invalid eventName");else console.warn("Mixpanel.track: You must call mixpanel.init(token) first")}function c(){var t,i,o=s.all(),a=o.map(function(t){return function(){var i,o=t.$set?n:r,a=(i=JSON.stringify(t),e.btoa(unescape(encodeURIComponent(i))));return o+=encodeURIComponent(a)+"&_="+(new Date).getTime(),t.__completed=!1,function(e){return new Promise(function(t,r){var n=new XMLHttpRequest;n.open("GET",e),n.withCredentials=!0,n.onreadystatechange=function(){4===n.readyState&&(200===n.status||0===n.status&&""!==n.responseText?t({url:e,status:200,body:n.responseText||""}):r({url:e,status:n.status,body:n.responseText||""}))},n.send()})}(o).then(function(){t.__completed=!0})}});return(t=a,i=Promise.resolve(),t.forEach(function(e){i=i.then(e)}),i).then(function(){var e=o.filter(function(e){return!e.__completed});s.reset(e)})}function u(){var t=navigator.userAgent,r=navigator.vendor||"";function n(e,t){return-1!==e.indexOf(t)}return e.opera||n(t," OPR/")?n(t,"Mini")?"Opera Mini":"Opera":/(BlackBerry|PlayBook|BB10)/i.test(t)?"BlackBerry":n(t,"IEMobile")||n(t,"WPDesktop")?"Internet Explorer Mobile":n(t,"Edge")?"Microsoft Edge":n(t,"FBIOS")?"Facebook Mobile":n(t,"Chrome")?"Chrome":n(t,"CriOS")?"Chrome iOS":n(t,"UCWEB")||n(t,"UCBrowser")?"UC Browser":n(t,"FxiOS")?"Firefox iOS":n(r,"Apple")?n(t,"Mobile")?"Mobile Safari":"Safari":n(t,"Android")?"Android Mobile":n(t,"Konqueror")?"Konqueror":n(t,"Firefox")?"Firefox":n(t,"MSIE")||n(t,"Trident/")?"Internet Explorer":n(t,"Gecko")?"Mozilla":""}}(this,document);