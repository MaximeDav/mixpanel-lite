/*!
 * mixpanel-lite.js - v1.0.1
 * Lightweight version of mixpanel-js with offline support
 * https://github.com/john-doherty/mixpanel-lite
 * @author John Doherty <www.johndoherty.info>
 * @license MIT
 */
!function(e,r){"use strict";if(!e.localStorage)throw new Error("localStorage not supported");if(!e.Promise)throw new Error("Promise not supported (try adding a polyfill)");var t="https://api.mixpanel.com/track/?data=",n=null,i={};function o(t){if(!t||""===t.trim())throw new Error("Invalid Mixpanel token");n=t;var o,a,s,d=(o=function(){for(var e=1*new Date,r=0;e==1*new Date;)r++;return e.toString(16)+r.toString(16)},a=(screen.height*screen.width).toString(16),o()+"-"+Math.random().toString(16).replace(".","")+"-"+function(){var e,r,t=navigator.userAgent,n=[],i=0;function o(e,r){var t,i=0;for(t=0;t<r.length;t++)i|=n[t]<<8*t;return e^i}for(e=0;e<t.length;e++)r=t.charCodeAt(e),n.unshift(255&r),n.length>=4&&(i=o(i,n),n=[]);return n.length>0&&(i=o(i,n)),i.toString(16)}()+"-"+a+"-"+o());i={token:t,$current_url:e.location.href,$os:(s=navigator.userAgent,/Windows/i.test(s)?/Phone/.test(s)||/WPDesktop/.test(s)?"Windows Phone":"Windows":/(iPhone|iPad|iPod)/.test(s)?"iOS":/Android/.test(s)?"Android":/(BlackBerry|PlayBook|BB10)/i.test(s)?"BlackBerry":/Mac/i.test(s)?"Mac OS X":/Linux/.test(s)?"Linux":/CrOS/.test(s)?"Chrome OS":""),$browser:c(),$browser_version:function(){var e=c(),r=navigator.userAgent,t={"Internet Explorer Mobile":/rv:(\d+(\.\d+)?)/,"Microsoft Edge":/Edge\/(\d+(\.\d+)?)/,Chrome:/Chrome\/(\d+(\.\d+)?)/,"Chrome iOS":/CriOS\/(\d+(\.\d+)?)/,"UC Browser":/(UCBrowser|UCWEB)\/(\d+(\.\d+)?)/,Safari:/Version\/(\d+(\.\d+)?)/,"Mobile Safari":/Version\/(\d+(\.\d+)?)/,Opera:/(Opera|OPR)\/(\d+(\.\d+)?)/,Firefox:/Firefox\/(\d+(\.\d+)?)/,"Firefox iOS":/FxiOS\/(\d+(\.\d+)?)/,Konqueror:/Konqueror:(\d+(\.\d+)?)/,BlackBerry:/BlackBerry (\d+(\.\d+)?)/,"Android Mobile":/android\s(\d+(\.\d+)?)/,"Internet Explorer":/(rv:|MSIE )(\d+(\.\d+)?)/,Mozilla:/rv:(\d+(\.\d+)?)/}[e];if(void 0===t)return null;var n=r.match(t);if(!n)return null;return parseFloat(n[n.length-2])}(),$device:function(){var e=navigator.userAgent;return/Windows Phone/i.test(e)||/WPDesktop/.test(e)?"Windows Phone":/iPad/.test(e)?"iPad":/iPod/.test(e)?"iPod Touch":/iPhone/.test(e)?"iPhone":/(BlackBerry|PlayBook|BB10)/i.test(e)?"BlackBerry":/Android/.test(e)?"Android":""}(),$screen_height:screen.height,$screen_width:screen.width,$referrer:r.referrer,$referring_domain:function(){var e=String(r.referrer||"").split("/");if(e.length>=3)return e[2];return""}(),distinct_id:d,$device_id:d,mp_lib:"mixpanel-lite",$lib_version:"1.0.0"}}function a(e,r){if(!n)throw new Error("You must call mixpanel.init(token) first");if(!e||""===e)throw new Error("Invalid eventName");if(r&&"object"!=typeof r)throw new Error("Data param must be an object");if(1!=navigator.doNotTrack){var t,o={event:e,properties:(t=i,JSON.parse(JSON.stringify(t)))};Object.keys(r||{}).forEach(function(e){o.properties[e]=r[e]}),o.properties.time=Date.now()/1e3,Object.keys(o.properties).forEach(function(e){o.properties[e]&&""!==o.properties[e]||delete o.properties[e]}),d.add(o),s()}}function s(){var e,r,n=d.all(),i=n.map(function(e){return function(){var r=t+encodeURIComponent(function(e){var r,t,n,i,o,a,s,d,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l=0,u=0,f="",h=[];if(!e)return e;e=function(e){e=(e+"").replace(/\r\n/g,"\n").replace(/\r/g,"\n");var r,t,n,i="",o=0;for(r=t=0,o=e.length,n=0;n<o;n++){var a=e.charCodeAt(n),s=null;a<128?t++:s=a>127&&a<2048?String.fromCharCode(a>>6|192,63&a|128):String.fromCharCode(a>>12|224,a>>6&63|128,63&a|128),null!==s&&(t>r&&(i+=e.substring(r,t)),i+=s,r=t=n+1)}t>r&&(i+=e.substring(r,e.length));return i}(e);do{r=e.charCodeAt(l++),t=e.charCodeAt(l++),n=e.charCodeAt(l++),i=(d=r<<16|t<<8|n)>>18&63,o=d>>12&63,a=d>>6&63,s=63&d,h[u++]=c.charAt(i)+c.charAt(o)+c.charAt(a)+c.charAt(s)}while(l<e.length);switch(f=h.join(""),e.length%3){case 1:f=f.slice(0,-2)+"==";break;case 2:f=f.slice(0,-1)+"="}return f}(JSON.stringify(e)))+"&ip=1&_"+(new Date).getTime();return e.__completed=!1,function(e){return new Promise(function(r,t){var n=new XMLHttpRequest;n.open("GET",e),n.withCredentials=!0,n.onreadystatechange=function(){4===n.readyState&&(200===n.status||0===n.status&&""!==n.responseText?r({url:e,status:200,body:n.responseText||""}):t({url:e,status:n.status,body:n.responseText||""}))},n.send()})}(r).then(function(){e.__completed=!0}).catch(function(r){delete e.__completed})}});return(e=i,r=Promise.resolve(),e.forEach(function(e){r=r.then(e)}),r).then(function(){var e=n.filter(function(e){return!e.__completed});d.reset(e)})}var d={_key:"mixpanel-lite",all:function(){return JSON.parse(localStorage.getItem(d._key)||"[]")},add:function(e){var r=d.all();r.push(e),localStorage.setItem(d._key,JSON.stringify(r))},clear:function(){localStorage.setItem(d._key,JSON.stringify([]))},reset:function(e){localStorage.setItem(d._key,JSON.stringify(e||[]))}};function c(){var r=navigator.userAgent,t=navigator.vendor,n=e.opera;function i(e,r){return-1!==e.indexOf(r)}return t=t||"",n||i(r," OPR/")?i(r,"Mini")?"Opera Mini":"Opera":/(BlackBerry|PlayBook|BB10)/i.test(r)?"BlackBerry":i(r,"IEMobile")||i(r,"WPDesktop")?"Internet Explorer Mobile":i(r,"Edge")?"Microsoft Edge":i(r,"FBIOS")?"Facebook Mobile":i(r,"Chrome")?"Chrome":i(r,"CriOS")?"Chrome iOS":i(r,"UCWEB")||i(r,"UCBrowser")?"UC Browser":i(r,"FxiOS")?"Firefox iOS":i(t,"Apple")?i(r,"Mobile")?"Mobile Safari":"Safari":i(r,"Android")?"Android Mobile":i(r,"Konqueror")?"Konqueror":i(r,"Firefox")?"Firefox":i(r,"MSIE")||i(r,"Trident/")?"Internet Explorer":i(r,"Gecko")?"Mozilla":""}e.addEventListener(e.cordova?"deviceready":"load",s,{passive:!0}),e.addEventListener("online",s,{passive:!0}),e.mixpanel={init:o,track:a,reset:function(){o(n)},identify:function(e){if(!e||""===e.trim())throw new Error("Invalid id");a("$identify",{distinct_id:e,$anon_distinct_id:i.distinct_id}),i.distinct_id=e}}}(this,document);